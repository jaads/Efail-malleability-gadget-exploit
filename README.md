# Efail-malleability-gadget-exploit

This project provides code to exploit malleability CFB (CVE-2017-17688) and CBC gadgets (CVE-2017-17689) published by [Efail](https://efail.de/). The paper for this project can be found [here](http://jarends.net/static/docs/Bachelorthesis_Jan_Arends.pdf).

The files `opgp_modification.py` and `smime_modification.py` are the execution points for the desired exploits. The project includes encrypted test messages for both, OpenPGP and S/MIME. However, any other message can be loaded into the program.

To do so, the path in `get_*_msg()` needs to be changed and the initialization adopted. For the latter I recommend using [this](https://cirw.in/gpg-decoder/) or [that](https://lapo.it/asn1js/) depending on the encryption standard.

It currently lacks on an implementation to defeat integrity protection in OpenPGP messages. This is however not necessary for some email clients. 
