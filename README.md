# Efail-malleability-gadget-exploit

This project provides code to exploit malleability CFB (CVE-2017-17688) and CBC gadgets (CVE-2017-17689) published by [Efail](https://efail.de/). 

The exploits resulted out of a thesis. It can be found [here](http://jarends.net/static/docs/Bachelorthesis_Jan_Arends.pdf) and offers a documentation for the project.

The files `opgp_modification.py` and `smime_modification.py` are the execution points for the desired exploits. The project includes encrypted test messages for both, OpenPGP and S/MIME. However, any other message can be loaded into the program.

## Adjustments
* __Ciphertexts:__ The path in `get_*_msg()` needs to be changed in order to load another ciphertext. Furthermore, the initialization needs to be adopted. For the latter I recommend using [this](https://cirw.in/gpg-decoder/) or [that](https://lapo.it/asn1js/) decoder depending on the encryption standard.
* __Emailserver:__ In addition, configurations regarding `smtplib` need to be made. Therefore you need to specify your email server, address and password in `config.txt`. An example file is given.

## Note
The exploits currently lack on an implementation to defeat integrity protection in OpenPGP messages. This is might be not necessary but depends on the targeting email client. 
